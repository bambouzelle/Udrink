{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport CocktailCard from \"@/components/CocktailCard.vue\";\nconst API_URL = 'http://127.0.0.1:8000';\nexport default {\n  components: {\n    CocktailCard\n  },\n  name: 'CocktailsView',\n  data() {\n    return {\n      data: [],\n      dataToShow: [],\n      ingredients: [],\n      noMore: false\n    };\n  },\n  mounted() {\n    //this.$store.dispatch('resetCocktails')\n    if (this.$store.state.listeCocktails.length == 0) {\n      this.getApiData();\n    }\n    this.getMoreData();\n  },\n  methods: {\n    getNextCocktails() {\n      window.onscroll = () => {\n        let bottomOfWindow = document.documentElement.scrollTop + window.innerHeight === document.documentElement.offsetHeight;\n        if (bottomOfWindow) {\n          console.log('rendu en bas');\n          this.getMoreData();\n        }\n      };\n    },\n    getMoreData() {\n      let i = this.dataToShow.length;\n      let imax = i + 10;\n      for (i; i < imax; i++) {\n        if (this.$store.state.listeCocktails[i]) {\n          this.dataToShow.push(this.$store.state.listeCocktails[i]);\n        } else {\n          this.noMore = true;\n        }\n      }\n    },\n    async getIngredients(cocktail) {\n      const url = `${API_URL}/cocktails/${cocktail.id}/ingredients`;\n      var myHeaders = new Headers();\n      myHeaders.append(\"Access-Control-Allow-Origin\", \"*\");\n      var requestOptions = {\n        method: 'GET',\n        headers: myHeaders,\n        redirect: 'follow'\n      };\n      let res = [];\n      const response = await fetch(url, requestOptions);\n      const data = await response.json();\n      await data.ingredients.forEach(element => {\n        res.push(element.nom);\n      });\n      this.$store.state.listeCocktails.forEach(el => {\n        if (el.nom == cocktail.nom) {\n          el.ingredients = res;\n        }\n      });\n    },\n    async getApiData() {\n      await this.getCocktails();\n      await this.$store.state.listeCocktails.forEach(cocktail => {\n        this.getIngredients(cocktail);\n        cocktail.ingredients = this.ingredients;\n      });\n    },\n    async getCocktails() {\n      const url = `${API_URL}/cocktails`;\n      var myHeaders = new Headers();\n      myHeaders.append(\"Access-Control-Allow-Origin\", \"*\");\n      var requestOptions = {\n        method: 'GET',\n        headers: myHeaders,\n        redirect: 'follow'\n      };\n      const response = await fetch(url, requestOptions);\n      const data = await response.json();\n      data.results.forEach(element => {\n        this.$store.dispatch('addCocktail', element);\n      });\n      this.getMoreData();\n      this.getNextCocktails();\n    }\n  }\n};","map":{"version":3,"names":["CocktailCard","API_URL","components","name","data","dataToShow","ingredients","noMore","mounted","$store","state","listeCocktails","length","getApiData","getMoreData","methods","getNextCocktails","window","onscroll","bottomOfWindow","document","documentElement","scrollTop","innerHeight","offsetHeight","console","log","i","imax","push","getIngredients","cocktail","url","id","myHeaders","Headers","append","requestOptions","method","headers","redirect","res","response","fetch","json","forEach","element","nom","el","getCocktails","results","dispatch"],"sources":["C:\\code\\Udrink\\udrinkfront\\src\\views\\Cocktails.vue"],"sourcesContent":["<!-- eslint-disable vue/multi-word-component-names -->\r\n<template>\r\n\t<div class=\"container\">\r\n\t\t<div class=\"row\">\r\n\t\t\t<div class=\"col\">\r\n\t\t\t\t<h1>Cocktails</h1>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div v-for=\"cocktail in dataToShow\" class=\"row\" :key=\"cocktail\" style=\"margin-top: 2em;\">\r\n\t\t\t<CocktailCard :cocktail=\"cocktail\"/>\r\n\t\t</div>\r\n\r\n\t\t<div v-if=\"noMore\"> Vous avez vu tout les cocktails !</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport CocktailCard from \"@/components/CocktailCard.vue\"\r\nconst API_URL = 'http://127.0.0.1:8000'\r\n\r\nexport default {\r\n\tcomponents: { CocktailCard },\r\n\tname: 'CocktailsView',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tdata:[],\r\n\t\t\tdataToShow:[],\r\n\t\t\tingredients:[],\r\n\t\t\tnoMore: false\r\n\t\t}\r\n\t},\r\n\tmounted(){\r\n\t\t//this.$store.dispatch('resetCocktails')\r\n\t\tif (this.$store.state.listeCocktails.length == 0){\r\n\t\t\t\t\tthis.getApiData();\r\n\t\t}\r\n\t\tthis.getMoreData();\r\n\t},\r\n\tmethods:{\r\n\t\tgetNextCocktails(){\r\n\t\t\twindow.onscroll = () => {\r\n\t\t\t\tlet bottomOfWindow = document.documentElement.scrollTop + window.innerHeight === document.documentElement.offsetHeight;\r\n\r\n\t\t\t\tif (bottomOfWindow) {\r\n\t\t\t\t\t\tconsole.log('rendu en bas')\r\n\t\t\t\t\t\tthis.getMoreData()\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tgetMoreData(){\r\n\t\t\tlet i = this.dataToShow.length;\r\n\t\t\tlet imax = i+10;\r\n\t\t\tfor ( i ; i<imax ; i++){\r\n\t\t\t\tif (this.$store.state.listeCocktails[i]){\r\n\t\t\t\t\tthis.dataToShow.push(this.$store.state.listeCocktails[i])\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tthis.noMore = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tasync getIngredients (cocktail) {\r\n      const url = `${API_URL}/cocktails/${cocktail.id}/ingredients`;\r\n\t\t\tvar myHeaders = new Headers();\r\n\t\t\tmyHeaders.append(\"Access-Control-Allow-Origin\", \"*\");\r\n\r\n\t\t\tvar requestOptions = {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: myHeaders,\r\n\t\t\tredirect: 'follow'\r\n\t\t\t};\r\n\r\n\t\t\tlet res = []\r\n\t\t\tconst response = await fetch(url, requestOptions)\r\n\t\t\tconst data = await response.json()\r\n\t\t\tawait data.ingredients.forEach(element => {\r\n\t\t\t\tres.push(element.nom)\r\n\t\t\t})\r\n\t\t\tthis.$store.state.listeCocktails.forEach(el => {\r\n\t\t\t\tif (el.nom == cocktail.nom){\r\n\t\t\t\t\tel.ingredients = res\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tasync getApiData () {\r\n\t\t\tawait this.getCocktails();\r\n\t\t\tawait this.$store.state.listeCocktails.forEach(cocktail => {\r\n\t\t\t\t\tthis.getIngredients(cocktail)\r\n\t\t\t\t\tcocktail.ingredients = this.ingredients\r\n\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tasync getCocktails(){\r\n      const url = `${API_URL}/cocktails`\r\n\t\t\tvar myHeaders = new Headers();\r\n\t\t\tmyHeaders.append(\"Access-Control-Allow-Origin\", \"*\");\r\n\r\n\t\t\tvar requestOptions = {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: myHeaders,\r\n\t\t\tredirect: 'follow'\r\n\t\t\t};\r\n\r\n\t\t\tconst response = await fetch(url, requestOptions)\r\n\t\t\tconst data = await response.json()\r\n\t\t\tdata.results.forEach(element => {\r\n\t\t\t\t\tthis.$store.dispatch('addCocktail', element)\r\n\t\t\t\t});\r\n\t\t\tthis.getMoreData();\r\n\t\t\tthis.getNextCocktails();\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style>\r\nul {\r\n\tlist-style-type: none;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}