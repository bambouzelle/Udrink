{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"row\"\n}, [/*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"col\"\n}, [/*#__PURE__*/_createElementVNode(\"h1\", null, \"Cocktails\")])], -1);\nconst _hoisted_3 = {\n  key: 0\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_CocktailCard = _resolveComponent(\"CocktailCard\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.dataToShow, cocktail => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      class: \"row\",\n      key: cocktail,\n      style: {\n        \"margin-top\": \"2em\"\n      }\n    }, [_createVNode(_component_CocktailCard, {\n      cocktail: cocktail\n    }, null, 8, [\"cocktail\"])]);\n  }), 128)), $data.noMore ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \" Vous avez vu tout les cocktails !\")) : _createCommentVNode(\"\", true)]);\n}","map":{"version":3,"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_Fragment","_renderList","$data","dataToShow","cocktail","key","style","_createVNode","_component_CocktailCard","noMore","_hoisted_3"],"sources":["C:\\code\\Udrink\\udrinkfront\\src\\views\\Cocktails.vue"],"sourcesContent":["<!-- eslint-disable vue/multi-word-component-names -->\r\n<template>\r\n\t<div class=\"container\">\r\n\t\t<div class=\"row\">\r\n\t\t\t<div class=\"col\">\r\n\t\t\t\t<h1>Cocktails</h1>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div v-for=\"cocktail in dataToShow\" class=\"row\" :key=\"cocktail\" style=\"margin-top: 2em;\">\r\n\t\t\t<CocktailCard :cocktail=\"cocktail\"/>\r\n\t\t</div>\r\n\r\n\t\t<div v-if=\"noMore\"> Vous avez vu tout les cocktails !</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport CocktailCard from \"@/components/CocktailCard.vue\"\r\nconst API_URL = 'http://127.0.0.1:8000'\r\n\r\nexport default {\r\n\tcomponents: { CocktailCard },\r\n\tname: 'CocktailsView',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tdata:[],\r\n\t\t\tdataToShow:[],\r\n\t\t\tingredients:[],\r\n\t\t\tnoMore: false\r\n\t\t}\r\n\t},\r\n\tmounted(){\r\n\t\t//this.$store.dispatch('resetCocktails')\r\n\t\tif (this.$store.state.listeCocktails.length == 0){\r\n\t\t\t\t\tthis.getApiData();\r\n\t\t}\r\n\t\tthis.getMoreData();\r\n\t},\r\n\tmethods:{\r\n\t\tgetNextCocktails(){\r\n\t\t\twindow.onscroll = () => {\r\n\t\t\t\tlet bottomOfWindow = document.documentElement.scrollTop + window.innerHeight === document.documentElement.offsetHeight;\r\n\r\n\t\t\t\tif (bottomOfWindow) {\r\n\t\t\t\t\t\tconsole.log('rendu en bas')\r\n\t\t\t\t\t\tthis.getMoreData()\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tgetMoreData(){\r\n\t\t\tlet i = this.dataToShow.length;\r\n\t\t\tlet imax = i+10;\r\n\t\t\tfor ( i ; i<imax ; i++){\r\n\t\t\t\tif (this.$store.state.listeCocktails[i]){\r\n\t\t\t\t\tthis.dataToShow.push(this.$store.state.listeCocktails[i])\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tthis.noMore = true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tasync getIngredients (cocktail) {\r\n      const url = `${API_URL}/cocktails/${cocktail.id}/ingredients`;\r\n\t\t\tvar myHeaders = new Headers();\r\n\t\t\tmyHeaders.append(\"Access-Control-Allow-Origin\", \"*\");\r\n\r\n\t\t\tvar requestOptions = {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: myHeaders,\r\n\t\t\tredirect: 'follow'\r\n\t\t\t};\r\n\r\n\t\t\tlet res = []\r\n\t\t\tconst response = await fetch(url, requestOptions)\r\n\t\t\tconst data = await response.json()\r\n\t\t\tawait data.ingredients.forEach(element => {\r\n\t\t\t\tres.push(element.nom)\r\n\t\t\t})\r\n\t\t\tthis.$store.state.listeCocktails.forEach(el => {\r\n\t\t\t\tif (el.nom == cocktail.nom){\r\n\t\t\t\t\tel.ingredients = res\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tasync getApiData () {\r\n\t\t\tawait this.getCocktails();\r\n\t\t\tawait this.$store.state.listeCocktails.forEach(cocktail => {\r\n\t\t\t\t\tthis.getIngredients(cocktail)\r\n\t\t\t\t\tcocktail.ingredients = this.ingredients\r\n\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tasync getCocktails(){\r\n      const url = `${API_URL}/cocktails`\r\n\t\t\tvar myHeaders = new Headers();\r\n\t\t\tmyHeaders.append(\"Access-Control-Allow-Origin\", \"*\");\r\n\r\n\t\t\tvar requestOptions = {\r\n\t\t\tmethod: 'GET',\r\n\t\t\theaders: myHeaders,\r\n\t\t\tredirect: 'follow'\r\n\t\t\t};\r\n\r\n\t\t\tconst response = await fetch(url, requestOptions)\r\n\t\t\tconst data = await response.json()\r\n\t\t\tdata.results.forEach(element => {\r\n\t\t\t\t\tthis.$store.dispatch('addCocktail', element)\r\n\t\t\t\t});\r\n\t\t\tthis.getMoreData();\r\n\t\t\tthis.getNextCocktails();\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style>\r\nul {\r\n\tlist-style-type: none;\r\n}\r\n</style>"],"mappings":";;EAEMA,KAAK,EAAC;AAAW;gCACrBC,mBAAA,CAIM;EAJDD,KAAK,EAAC;AAAK,I,aACfC,mBAAA,CAEM;EAFDD,KAAK,EAAC;AAAK,I,aACfC,mBAAA,CAAkB,YAAd,WAAS,E;;;;;;uBAHhBC,mBAAA,CAYM,OAZNC,UAYM,GAXLC,UAIM,G,kBAENF,mBAAA,CAEMG,SAAA,QAAAC,WAAA,CAFkBC,KAAA,CAAAC,UAAU,EAAtBC,QAAQ;yBAApBP,mBAAA,CAEM;MAF8BF,KAAK,EAAC,KAAK;MAAEU,GAAG,EAAED,QAAQ;MAAEE,KAAwB,EAAxB;QAAA;MAAA;QAC/DC,YAAA,CAAoCC,uBAAA;MAArBJ,QAAQ,EAAEA;IAAQ,0B;aAGvBF,KAAA,CAAAO,MAAM,I,cAAjBZ,mBAAA,CAA2D,OAAAa,UAAA,EAAxC,oCAAkC,K"},"metadata":{},"sourceType":"module","externalDependencies":[]}